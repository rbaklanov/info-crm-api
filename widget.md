## Особенности работы виджета 

### Подключение виджета
В разделе ``<head>...</head>`` страницы нужно подключить следующие скрипты (если подключена доругая версия jquery, первая строка необязательна):
```html
<script src="//cdnjs.cloudflare.com/ajax/libs/jquery/2.2.4/jquery.min.js"></script>
<script src="//info-crm.test/js/bwcode.js?v=3"></script>
```  

### Вызов виджета

#### Запуск виджета

Существует 2 варианта отображения виджета - в узкой (500px) боковой панели или в новом табе браузера.

#### Виджет в боковой панели 

Для вызова виджета можно использовать различные html-элементы (div, a, button). Важно, чтобы элемент содержал 2 обязательных параметра из указанного списка:
* **class="bw_link"** - обязательный параметр, класс-идентификатор, к которому привязан обработчик, запускающий виджет.
* **data-id** - обязательный параметр, содержащий ID организации
* **data-lng** - необязательный параметр, код локали для виджета.

##### Примеры элементов, вызывающих виджет:

```html
<a href="javascript:void(0);" class="bw_link" data-id="2" data-lang="ru">Записаться онлайн</a>
<div class="bw_link" data-id="3">Записаться онлайн</div>
<button class="bw_link" data-id="1" data-lang="es" type="button">Записаться онлайн!</button>
```

#### Виджет в новом табе браузера

Для вызова виджета в новом табе используется классический вариант ссылки с атрибутом.
* тег должен обязательно содержать атрибут *target="_blank"*, иначе виджет откроется в текущем окне браузера
* ссылка должна вести на урл: *http://infogroup.online/api/v1/widget/show*
* урл должен содержать несколько get-параметров:
  * **sid** - обязательный параметр, содержащий ID организации
  * **lng** - необязательный параметр, код локали для виджета

##### Пример:
```html
  <a href="http://infogroup.online/api/v1/widget/show?sid=2&lng=ru" target="_blank">Записаться онлайн</a>
```

### Отклик  виджета

При нажатии на кнопку "Записаться" (отправка формы виджета) на родительскую страницу отправляется 2 события, "услышав" которые, можно выполнить какие-то свои действия(отправка метрик и прочее). События имеют метки "_ig_wigdet_complete" и "booking". Код обработчика события размещается на родительской по отношении к виджету странице и выглядит следующим образом:  

```javascript
window.addEventListener('message', function (event) {
    if (event.data.event == "_ig_wigdet_complete") {
        // Ваш код реакции на отклик виджета
        console.log('got _ig_wigdet_complete');            
    }
}, false);
window.addEventListener('message', function (event) {
    if (event.data.event == "booking") {
        // Ваш код реакции на отклик виджета
        console.log('got booking');            
    }
}, false);
```